clear;
clc;

A = [1,    0.03333333,    0,            0;
     0,    1,             -0.06,  0;
     0,    0,             1,            0.03333333;
     0,    0,             0.89,   1        ];


B = [0; 0.03341688; 0; -0.0783208];



SP = [7.3021,    3.4845,    8.4174,    1.8421;
     3.4845,    2.1165,    5.1401,    1.1252;
     8.4174,    5.1401,   14.8371,    2.9166;
     1.8421,    1.1252,    2.9166,    0.6411]*1;



% A2 = [1	0.0166666666666667	0	0;
%      0	1	-0.0282455903201080	0;
%      0	0	1	0.0166666666666667;
%      0	0	0.449013005410375	1];
% 
% B2 = [0;
%       0.0167084348716417;
%       0;
%     -0.0391603746502148];
% 
% P2 = [2.75094110803732	1.06292771456379	3.05159866452081	0.641996583286987;
%       1.06292771456379	0.898973884948197	2.38202789769940	0.502407959239469;
%       3.05159866452081	2.38202789769940	9.08327478948450	1.58946919395285;
%       0.641996583286987	0.502407959239469	1.58946919395285	0.385338261638770];

beta1 = 0.002;

eta = 1.01;
beta = 0.99;
kappa = 0.04;


setlmis([]) 
Q = lmivar(1,[4 1]); 
R = lmivar(2,[1 4]);
 
lmiterm([1 1 1 Q], eye(4), SP);
lmiterm([1 1 1 0], -eye(4));

lmiterm([-2 1 1 Q], eta*eye(4), SP);
lmiterm([-2 1 1 0], -eye(4));

lmiterm([-3 1 1 Q],1,1);

lmiterm([-4 1 1 Q],1,(beta - 2*eta*kappa)*eye(4));
lmiterm([-4 2 1 Q],A,1);
lmiterm([-4 2 1 R],B,1);
lmiterm([-4 2 2 Q],1,1);

lmiterm([-5 1 1 Q],1,1);
lmiterm([-5 2 1 R],1,1);
lmiterm([-5 2 2 0],1/beta1);

mylmi = getlmis;

[tmin, psol] = feasp(mylmi);
Q = dec2mat(mylmi, psol, Q)

R = dec2mat(mylmi, psol, R)

F = R*inv(Q)